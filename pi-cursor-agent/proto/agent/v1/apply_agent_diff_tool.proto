syntax = "proto3";

package agent.v1;

enum AppliedAgentChange_ChangeType {
  CHANGE_TYPE_UNSPECIFIED = 0;
  CHANGE_TYPE_CREATED = 1;
  CHANGE_TYPE_MODIFIED = 2;
  CHANGE_TYPE_DELETED = 3;
}

message ApplyAgentDiffToolCall {
  ApplyAgentDiffArgs args = 1;
  ApplyAgentDiffResult result = 2;
}

message ApplyAgentDiffArgs {
  string agent_id = 1;
}

message ApplyAgentDiffResult {
  oneof result {
    ApplyAgentDiffSuccess success = 1;
    ApplyAgentDiffError error = 2;
  }
}

message ApplyAgentDiffSuccess {
  repeated AppliedAgentChange applied_changes = 1;
}

message AppliedAgentChange {
  string path = 1;
  AppliedAgentChange_ChangeType change_type = 2;
  optional string before_content = 3;
  optional string after_content = 4;
  optional string error = 5;
  optional string message_for_model = 6;
}

message ApplyAgentDiffError {
  string error = 1;
  repeated AppliedAgentChange applied_changes = 2;
}
